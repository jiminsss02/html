<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello World</title>
    <style>
        body {
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        .calculator {
            color: red;
            font-weight: bold;
        }
        .form-container {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: white;
        }
        select, input, button {
            margin: 10px 5px;
            padding: 8px;
            font-size: 14px;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>계산기</h1>
    <p><span class="calculator">덧셈</span> 계산기</p>
    <p><span class="calculator">뺄셈</span> 계산기</p>
    <p><span class="calculator">곱셈</span> 계산기</p>
    <p><span class="calculator">나눗셈</span> 계산기</p>
    
    <div class="form-container">
        <h2>계산기 선택</h2>
        <form id="calculatorForm">
            <label for="operation">연산 선택:</label>
            <select id="operation" name="operation" required>
                <option value="">연산을 선택하세요</option>
                <option value="add">덧셈</option>
                <option value="subtract">뺄셈</option>
                <option value="multiply">곱셈</option>
                <option value="divide">나눗셈</option>
            </select>
            
            <br><br>
            
            <label for="num1">첫 번째 숫자:</label>
            <input type="number" id="num1" name="num1" required>
            
            <label for="num2">두 번째 숫자:</label>
            <input type="number" id="num2" name="num2" required>
            
            <br><br>
            
            <button type="submit">계산하기</button>
        </form>
        
        <div id="result" style="margin-top: 20px; font-size: 18px; font-weight: bold;"></div>
    </div>

    <script>
        document.getElementById('calculatorForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const operation = formData.get('operation');
            const num1 = parseFloat(formData.get('num1'));
            const num2 = parseFloat(formData.get('num2'));
            
            const resultDiv = document.getElementById('result');
            
            try {
                // 자바 서버로 데이터 전송
                const response = await fetch('http://localhost:8080/calculate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        operation: operation,
                        num1: num1,
                        num2: num2
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    resultDiv.innerHTML = `결과: ${result.result}`;
                    resultDiv.style.color = 'green';
                } else {
                    throw new Error('서버 오류');
                }
            } catch (error) {
                // 자바 서버가 연결되지 않은 경우 클라이언트에서 계산
                console.log('자바 서버 연결 실패, 클라이언트에서 계산합니다.');
                let result;
                
                switch(operation) {
                    case 'add':
                        result = num1 + num2;
                        break;
                    case 'subtract':
                        result = num1 - num2;
                        break;
                    case 'multiply':
                        result = num1 * num2;
                        break;
                    case 'divide':
                        if (num2 === 0) {
                            resultDiv.innerHTML = '오류: 0으로 나눌 수 없습니다.';
                            resultDiv.style.color = 'red';
                            return;
                        }
                        result = num1 / num2;
                        break;
                    default:
                        resultDiv.innerHTML = '올바른 연산을 선택하세요.';
                        resultDiv.style.color = 'red';
                        return;
                }
                
                resultDiv.innerHTML = `결과: ${result}`;
                resultDiv.style.color = 'blue';
            }
        });
    </script>
</body>
</html>
